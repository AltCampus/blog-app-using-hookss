{"ast":null,"code":"import _defineProperty from\"/home/somanshu/Desktop/altcampus/REACT/blog-app/blog-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _classCallCheck from\"/home/somanshu/Desktop/altcampus/REACT/blog-app/blog-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/somanshu/Desktop/altcampus/REACT/blog-app/blog-app/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/somanshu/Desktop/altcampus/REACT/blog-app/blog-app/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/somanshu/Desktop/altcampus/REACT/blog-app/blog-app/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from\"react\";import{NavLink}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var commentUrl;var Comment=/*#__PURE__*/function(_React$Component){_inherits(Comment,_React$Component);var _super=_createSuper(Comment);function Comment(props){var _this;_classCallCheck(this,Comment);_this=_super.call(this);_this.handleInput=function(_ref){var target=_ref.target;var name=target.name,value=target.value;_this.setState(_defineProperty({},name,value));};_this.checkInput=function(){var comment=_this.state.comment;if(!comment){_this.setState({error:\"comment required to add*\"});}};_this.addComment=function(){var comment=_this.state.comment;fetch(commentUrl,{method:\"POST\",headers:{\"Content-Type\":\"application/json\",authorization:\"\".concat(_this.props.user.token)},body:JSON.stringify({comment:{body:comment}})}).then(function(res){if(!res.ok){throw new Error(\"cant add new comment\");}return res.json();}).then(function(comment){_this.setState({comment:\"\"},function(){_this.fetchComments();});}).catch(function(errors){_this.setState({error:errors.error});});};_this.fetchComments=function(){fetch(commentUrl).then(function(res){if(!res.ok){throw new Error(\"cant fetch comments\");}return res.json();}).then(function(comments){_this.setState({comments:comments.comments});}).catch(function(errors){_this.setState({error:errors.error});});};_this.deleteComment=function(id){fetch(\"\".concat(commentUrl,\"/\").concat(id),{method:\"DELETE\",headers:{\"Content-Type\":\"application/json\",authorization:\"\".concat(_this.props.user.token)}}).then(function(res){if(!res.ok){throw new Error(\"can't delete comment\");}return res.json();}).then(function(data){_this.setState({comments:[]},function(){_this.fetchComments();});}).catch(function(errors){_this.setState({error:errors.error});});};_this.state={comment:\"\",error:\"\",comments:[]};return _this;}_createClass(Comment,[{key:\"componentDidMount\",value:function componentDidMount(){commentUrl=\"/api/articles/\".concat(this.props.slug,\"/comments\");this.fetchComments();}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,comment=_this$state.comment,error=_this$state.error;var formControlClass=\"text-sm rounded-md w-full py-1 px-4 my-2 border-2 border-solid border-blue-900 text-blue-900\";return/*#__PURE__*/_jsxs(\"div\",{className:\" w-1/3 mx-auto\",children:[this.props.user?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:function onSubmit(event){event.preventDefault();_this2.checkInput();if(!error){_this2.addComment();}},children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500 text-sm\",children:this.state.error}),/*#__PURE__*/_jsx(\"textarea\",{className:formControlClass,placeholder:\"Write comment\",rows:3,onChange:this.handleInput,value:comment,name:\"comment\"}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Add Comment\",className:\"bg-blue-300 hover:scale-110 blue \".concat(formControlClass)})]})}):/*#__PURE__*/_jsx(NavLink,{to:\"/login\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-base m-4 text-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-500\",children:\"SignIn/SignUp\"}),\" to add\",/*#__PURE__*/_jsx(\"span\",{className:\"blue\",children:\" Comment\"})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"blue text-lg m-4 text-center\",children:\"Comments\"}),this.state.comments.map(function(comment,i){return/*#__PURE__*/_jsx(SingleComment,{deleteComment:_this2.deleteComment,user:_this2.props.user,comment:comment},i);})]})]});}}]);return Comment;}(React.Component);export{Comment as default};function SingleComment(props){return/*#__PURE__*/_jsxs(\"div\",{className:\"my-3 comment flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"blue text-base\",children:props.comment.body}),/*#__PURE__*/_jsx(\"address\",{className:\"text-xs capitalize\",children:props.comment.author.username}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs -mt-4\",children:props.comment.createdAt.slice(0,10)})]}),props.user&&props.user.username===props.comment.author.username?/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){props.deleteComment(props.comment.id);},className:\"text-red-500 text-xs hover:scale-125\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa-solid fa-trash\"})}):\"\"]});}","map":{"version":3,"names":["React","NavLink","commentUrl","Comment","props","handleInput","target","name","value","setState","checkInput","comment","state","error","addComment","fetch","method","headers","authorization","user","token","body","JSON","stringify","then","res","ok","Error","json","fetchComments","catch","errors","comments","deleteComment","id","data","slug","formControlClass","event","preventDefault","map","i","Component","SingleComment","author","username","createdAt","slice"],"sources":["/home/somanshu/Desktop/altcampus/REACT/blog-app/blog-app/src/components/comment.js"],"sourcesContent":["import React from \"react\";\nimport { NavLink } from \"react-router-dom\";\nlet commentUrl;\n\nexport default class Comment extends React.Component {\n  constructor(props) {\n    super();\n    this.state = {\n      comment: \"\",\n      error: \"\",\n      comments: [],\n    };\n  }\n  handleInput = ({ target }) => {\n    let { name, value } = target;\n    this.setState({\n      [name]: value,\n    });\n  };\n  checkInput = () => {\n    let { comment } = this.state;\n    if (!comment) {\n      this.setState({\n        error: \"comment required to add*\",\n      });\n    }\n  };\n  componentDidMount() {\n    commentUrl = `/api/articles/${this.props.slug}/comments`;\n    this.fetchComments();\n  }\n  addComment = () => {\n    let { comment } = this.state;\n    fetch(commentUrl, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        authorization: `${this.props.user.token}`,\n      },\n      body: JSON.stringify({\n        comment: {\n          body: comment,\n        },\n      }),\n    })\n      .then((res) => {\n        if (!res.ok) {\n          throw new Error(\"cant add new comment\");\n        }\n        return res.json();\n      })\n      .then((comment) => {\n        this.setState(\n          {\n            comment: \"\",\n          },\n          () => {\n            this.fetchComments();\n          }\n        );\n      })\n      .catch((errors) => {\n        this.setState({\n          error: errors.error,\n        });\n      });\n  };\n  fetchComments = () => {\n    fetch(commentUrl)\n      .then((res) => {\n        if (!res.ok) {\n          throw new Error(\"cant fetch comments\");\n        }\n        return res.json();\n      })\n      .then((comments) => {\n        this.setState({\n          comments: comments.comments,\n        });\n      })\n      .catch((errors) => {\n        this.setState({\n          error: errors.error,\n        });\n      });\n  };\n  deleteComment = (id) => {\n    fetch(`${commentUrl}/${id}`, {\n      method: \"DELETE\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        authorization: `${this.props.user.token}`,\n      },\n    })\n      .then((res) => {\n        if (!res.ok) {\n          throw new Error(\"can't delete comment\");\n        }\n        return res.json();\n      })\n      .then((data) => {\n        this.setState(\n          {\n            comments: [],\n          },\n          () => {\n            this.fetchComments();\n          }\n        );\n      })\n      .catch((errors) => {\n        this.setState({\n          error: errors.error,\n        });\n      });\n  };\n  render() {\n    let { comment, error } = this.state;\n    let formControlClass =\n      \"text-sm rounded-md w-full py-1 px-4 my-2 border-2 border-solid border-blue-900 text-blue-900\";\n\n    return (\n      <div className=\" w-1/3 mx-auto\">\n        {this.props.user ? (\n          <>\n            <form\n              onSubmit={(event) => {\n                event.preventDefault();\n                this.checkInput();\n                if (!error) {\n                  this.addComment();\n                }\n              }}\n            >\n              <span className=\"text-red-500 text-sm\">{this.state.error}</span>\n              <textarea\n                className={formControlClass}\n                placeholder=\"Write comment\"\n                rows={3}\n                onChange={this.handleInput}\n                value={comment}\n                name=\"comment\"\n              ></textarea>\n              <input\n                type=\"submit\"\n                value=\"Add Comment\"\n                className={`bg-blue-300 hover:scale-110 blue ${formControlClass}`}\n              ></input>\n            </form>\n          </>\n        ) : (\n          <NavLink to={\"/login\"}>\n            <p className=\"text-base m-4 text-center\">\n              <span className=\"text-green-500\">SignIn/SignUp</span> to add\n              <span className=\"blue\"> Comment</span>\n            </p>\n          </NavLink>\n        )}\n        <div>\n          <h4 className=\"blue text-lg m-4 text-center\">Comments</h4>\n          {this.state.comments.map((comment, i) => {\n            return (\n              <SingleComment\n                deleteComment={this.deleteComment}\n                user={this.props.user}\n                key={i}\n                comment={comment}\n              />\n            );\n          })}\n        </div>\n      </div>\n    );\n  }\n}\n\nfunction SingleComment(props) {\n  return (\n    <div className=\"my-3 comment flex justify-between items-center\">\n      <div>\n        <p className=\"blue text-base\">{props.comment.body}</p>\n        <address className=\"text-xs capitalize\">\n          {props.comment.author.username}\n        </address>\n        <span className=\"text-xs -mt-4\">\n          {props.comment.createdAt.slice(0, 10)}\n        </span>\n      </div>\n      {props.user && props.user.username === props.comment.author.username ? (\n        <button\n          onClick={() => {\n            props.deleteComment(props.comment.id);\n          }}\n          className=\"text-red-500 text-xs hover:scale-125\"\n        >\n          <i className=\"fa-solid fa-trash\"></i>\n        </button>\n      ) : (\n        \"\"\n      )}\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}